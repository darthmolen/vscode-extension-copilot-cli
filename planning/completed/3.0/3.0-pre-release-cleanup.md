# 3.0 Pre-Release Cleanup Checklist

**Purpose**: Track temporary debug code and development artifacts to remove before releasing 3.0

**Status**: In Development (DO NOT RELEASE YET)

---

## Debug Logging to Remove

### Webview Debug Logs

**File**: `src/webview/main.js`

**Lines to remove**:

1. **handleWorkspacePathMessage** (~lines 653-657)
   ```javascript
   console.log(`[VIEW PLAN DEBUG] workspacePath message received:`, payload);
   console.log(`[VIEW PLAN DEBUG] Extracted path: ${workspacePath}`);
   console.log(`[VIEW PLAN DEBUG] Button display set to: ${viewPlanBtn.style.display}`);
   ```
   **Reason**: Added to debug View Plan button session resume bug
   **Commit**: (latest debug commit)

### Extension Debug Logs

**File**: `src/chatViewProvider.ts`

Search for: `[VIEW PLAN DEBUG]`, `[DIAGNOSTIC]`

**Status**: Most were removed in commit `a307507`, verify none remain

**File**: `src/extension.ts`

Search for: `[VIEW PLAN DEBUG]`

**Status**: Removed in commit `a307507`, verify clean

---

## Verification Steps

Before releasing 3.0:

1. **Search for debug markers**:
   ```bash
   grep -r "VIEW PLAN DEBUG" src/
   grep -r "DIAGNOSTIC" src/
   grep -r "console.log" src/webview/
   ```

2. **Test without debug logs**:
   - Session resume with View Plan button
   - Diff button functionality
   - All critical paths from Phase 0.2-4.0

3. **Verify tests still pass**:
   ```bash
   npm test
   ```

4. **Manual smoke test**:
   - Create new session
   - Resume existing session
   - Toggle plan mode
   - View diff
   - View plan.md
   - Switch sessions
   - Send message with attachments

---

## Other Cleanup Tasks

### Test Files

- [ ] Remove any `.only()` from test files
- [ ] Remove commented-out test code
- [ ] Verify all test files in `tests/` are needed

### Documentation

- [ ] Update CHANGELOG.md with all 3.0 features
- [ ] Update README.md with new features
- [ ] Verify version numbers match in:
  - package.json
  - CHANGELOG.md
  - README.md

### Build Artifacts

- [ ] Remove development VSIX files (keep only latest)
- [ ] Clean `dist/` and rebuild fresh
- [ ] Verify esbuild.js copies all necessary files

### Git

- [ ] Squash/clean up commit history if needed
- [ ] Ensure all features are on `main` branch
- [ ] Tag release: `git tag v3.0.0`

---

## Known Temporary Code

### Planning Mode Debug

**Status**: Check if any planning mode debug code remains

**Files to check**:
- `src/sdkSessionManager.ts` - Plan mode implementation
- `src/webview/main.js` - Plan mode UI

---

## Pre-Release Command

**Run this before releasing 3.0**:

```bash
# Remove all debug logs
grep -r "console.log.*DEBUG" src/ --files-with-matches | xargs sed -i '/console.log.*DEBUG/d'

# Verify clean
grep -r "DEBUG\|DIAGNOSTIC" src/

# Rebuild
npm run compile

# Test
npm test

# Create VSIX
npx @vscode/vsce package --no-git-tag-version

# Manual test the VSIX
code --install-extension copilot-cli-extension-3.0.0.vsix --force
```

---

## Release Checklist

- [ ] All debug logs removed
- [ ] All tests passing
- [ ] Version updated in package.json
- [ ] CHANGELOG.md updated
- [ ] README.md updated
- [ ] Manual smoke test complete
- [ ] VSIX built and tested
- [ ] Git tagged
- [ ] Ready to publish

---

## Notes

**Why we keep debug logs during development**:

The View Plan button bug taught us that timing issues are hard to diagnose without detailed logging. We keep these logs active during 3.0 development to catch similar issues early.

**When to remove**:

Just before final release. Not before, because we might encounter more timing bugs during testing.

**TDD approach**:

Even with debug logs removed, our 66 tests will catch regressions. The logs are for diagnosing NEW issues, not preventing OLD ones.
