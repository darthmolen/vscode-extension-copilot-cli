# v2.2.1 Testing Guide

## Quick Testing Checklist

### ‚úÖ Build & Install (Already Done)
- [x] Compilation successful
- [x] VSIX packaging successful  
- [x] Extension installed: v2.2.1
- [ ] **YOU MUST DO**: Reload VS Code window (`Ctrl+Shift+P` ‚Üí "Developer: Reload Window")

### üîç What to Test

#### 1. Normal Operation (Valid Auth)
**Expected**: Extension works normally

1. Open chat panel (`Ctrl+Shift+P` ‚Üí "Copilot CLI: Open Chat")
2. Session should start without errors
3. Send a test message
4. Verify you get a response

**Result**: ‚¨ú Pass / ‚¨ú Fail

---

#### 2. Configuration Visibility
**Expected**: New setting is visible

1. Open Settings (`Ctrl+,`)
2. Search: "Copilot CLI GH SSO Enterprise Slug"
3. Should see new setting with description
4. Description should mention "SSO-enabled organizations only"

**Result**: ‚¨ú Pass / ‚¨ú Fail

---

#### 3. Documentation Quality
**Expected**: Authentication section is clear

1. View README.md in the extension
2. Find "Authentication" section (should be before "Quick Start")
3. Should have 3 subsections:
   - Option 1: Interactive Login (Recommended)
   - Option 2: Environment Variable
   - GitHub Enterprise with SSO
4. Check for code examples and step-by-step instructions

**Result**: ‚¨ú Pass / ‚¨ú Fail

---

#### 4. CHANGELOG Accuracy
**Expected**: v2.2.1 documented

1. View CHANGELOG.md
2. Find `## [2.2.1] - 2026-02-06` section
3. Should have 5 subsections under "Authentication & Enterprise Support"
4. Check for authentication detection, terminal flow, env vars, enterprise SSO, documentation

**Result**: ‚¨ú Pass / ‚¨ú Fail

---

## üß™ Advanced Testing (Optional)

### Test Scenario A: Unauthenticated State

‚ö†Ô∏è **WARNING**: This requires logging out of Copilot CLI. Only do this if you:
- Know how to re-authenticate afterward
- Are comfortable with backing up and restoring credentials
- Have time to test and recover

**Steps**:
1. Backup credentials (if they exist):
   ```bash
   # Find copilot config directory
   ls -la ~/.config/copilot/
   # Backup if exists (exact path may vary)
   cp -r ~/.config/copilot/ ~/.config/copilot.backup/
   ```

2. Test unauthenticated flow:
   ```bash
   # Remove auth (BE CAREFUL - you'll need to re-auth)
   rm -rf ~/.config/copilot/
   ```

3. Open VS Code ‚Üí Open Copilot CLI chat panel

4. **Expected**:
   - Error message: "Copilot CLI not authenticated. Authenticate to continue."
   - Two buttons: "Authenticate Now", "Retry"
   
5. Click "Authenticate Now"
   
6. **Expected**:
   - Terminal opens with name "Copilot Auth"
   - Command pre-filled: `copilot login`
   - Information message: "Complete authentication in the terminal, then click Retry."

7. Complete authentication in terminal (follow device code flow)

8. Click "Retry" button

9. **Expected**:
   - Session starts successfully
   - No more authentication errors

10. Restore backup if needed:
    ```bash
    cp -r ~/.config/copilot.backup/ ~/.config/copilot/
    ```

**Result**: ‚¨ú Pass / ‚¨ú Fail / ‚¨ú Skipped

---

### Test Scenario B: Invalid Token

‚ö†Ô∏è **WARNING**: This requires setting an invalid token. Only do this if you're comfortable with environment variables.

**Steps**:
1. Close VS Code completely

2. Set invalid token:
   ```bash
   export GH_TOKEN="invalid_token_test"
   code /home/smolen/dev/vscode-copilot-cli-extension
   ```

3. Open Copilot CLI chat panel

4. **Expected**:
   - Error message: "Authentication failed. Your GH_TOKEN appears to be invalid or expired."
   - Three buttons: "Show Instructions", "Open Terminal", "Retry"

5. Click "Show Instructions"

6. **Expected**:
   - Browser opens to GitHub Copilot CLI documentation

7. Click "Open Terminal"

8. **Expected**:
   - Terminal opens
   - Information message suggests updating token or unsetting

9. Unset token and restart:
   ```bash
   unset GH_TOKEN
   # Reload VS Code window
   ```

10. Click "Retry"

11. **Expected**:
    - Should fall back to OAuth authentication flow
    - Or session starts if valid credentials exist

**Result**: ‚¨ú Pass / ‚¨ú Fail / ‚¨ú Skipped

---

### Test Scenario C: Enterprise SSO Configuration

‚ö†Ô∏è **Only applicable if you have GitHub Enterprise with SSO**

**Steps**:
1. Open Settings (`Ctrl+,`)

2. Search: "Copilot CLI GH SSO Enterprise Slug"

3. Enter your enterprise slug (e.g., `acme`)

4. Try to enter invalid slug (e.g., `Acme-Corp!@#`)

5. **Expected**:
   - Validation error: "Slug must contain only lowercase letters, numbers, and hyphens"

6. Enter valid slug: `acme` (lowercase, no special chars)

7. Trigger authentication flow (logout first or use invalid token method above)

8. Click "Authenticate Now"

9. **Expected**:
   - Terminal opens
   - Command: `copilot login --host https://github.com/enterprises/acme/sso`
   - Information message mentions SSO for enterprise "acme"

10. Complete SSO authentication in terminal

11. Click "Retry"

12. **Expected**:
    - Session starts successfully with enterprise authentication

**Result**: ‚¨ú Pass / ‚¨ú Fail / ‚¨ú Skipped (No Enterprise)

---

## üìä Test Summary

### Core Functionality (Required)
- [ ] Normal operation works (valid auth)
- [ ] Configuration setting visible
- [ ] Documentation clear and comprehensive
- [ ] CHANGELOG accurate and complete

### Advanced Scenarios (Optional)
- [ ] Unauthenticated detection works
- [ ] Invalid token detection works
- [ ] Enterprise SSO configuration works

### Issues Found
List any issues discovered during testing:

1. _________________________
2. _________________________
3. _________________________

### Notes
_______________________________________
_______________________________________
_______________________________________

---

## üöÄ After Testing

If all tests pass (or you're satisfied with the results):

```bash
cd /home/smolen/dev/vscode-copilot-cli-extension

# Commit changes
git add -A
git commit -m "v2.2.1: Authentication detection & enterprise support"

# Tag release
git tag v2.2.1

# Push to remote
git push && git push --tags
```

If issues found:
- Document in "Issues Found" section above
- Report back for fixes
- Re-test after fixes applied

---

**Testing Date**: __________________  
**Tested By**: __________________  
**VS Code Version**: __________________  
**Extension Version**: v2.2.1  
**Overall Result**: ‚¨ú Pass / ‚¨ú Fail / ‚¨ú Needs Revision
